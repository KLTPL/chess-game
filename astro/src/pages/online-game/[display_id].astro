---
import MainLayout from "../../layouts/main-layout.astro";

const displayId = Astro.params.display_id as string;

Astro.cookies.set("displayId", displayId);
---

<MainLayout title="Online game" />

<script>
  import type { GetDBGameData } from "../../db/types";
  import { initGameOnline } from "../../scripts/initOnlineGame";
  import getCookie from "../../scripts/getCookie";

  const response = await fetch(
    `${import.meta.env.PUBLIC_URL}/api/online-game/${getCookie("displayId")}.json`
  );
  if (response.status >= 400) {
    window.location.replace("/404");
  } else {
    const DBGame: GetDBGameData = await response.json();
    initGameOnline("[data-page-container]", DBGame);
  }
</script>
